{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\naxios.defaults.baseURL = 'https://pixabay.com';\n\nexport async function fetchImages(userInput, currentPage) {\n  const params = {\n    q: userInput,\n    page: currentPage,\n    per_page: 15,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: 'true',\n    key: '44394535-420bbb6d9539431cf03571547',\n  };\n  const response = await axios.get('/api/', { params });\n  console.log(response);\n  return response.data;\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nexport const refs = {\n  formEl: document.querySelector('.search-box'),\n  inputEl: document.querySelector('#search-image'),\n  searchBtn: document.querySelector('.search-btn'),\n  listEl: document.querySelector('.image-list'),\n  loader: document.querySelector('.load-box'),\n  loadMoreBtn: document.querySelector('.load-btn'),\n};\n\nexport let page = 1;\n\nfunction imageTemplate({\n  webformatURL,\n  largeImageURL,\n  tags,\n  likes,\n  views,\n  comments,\n  downloads,\n}) {\n  return `<li class=\"list-item\">\n    <div class=\"box-image\">\n      <a href=\"${largeImageURL}\" class=\"list-link\">\n        <img src=\"${webformatURL}\" alt=\"${tags}\" title=\"${tags}\">\n      </a>\n    </div>\n    <div class=\"stats-box\">\n      <div class=\"likes-box\">\n        <span class=\"text\">Likes</span>\n        <span class=\"value\">${likes}</span>\n      </div>\n      <div class=\"views-box\">\n        <span class=\"text\">Views</span>\n        <span class=\"value\">${views}</span>\n      </div>\n      <div class=\"comments-box\">\n        <span class=\"text\">Comments</span>\n        <span class=\"value\">${comments}</span>\n      </div>\n      <div class=\"downloads-box\">\n        <span class=\"text\">Downloads</span>\n        <span class=\"value\">${downloads}</span>\n      </div>\n    </div>\n  </li>`;\n}\n\nexport function imagesTemplate(imagesArr) {\n  return imagesArr.map(imageTemplate).join('');\n}\n\nexport function showError() {\n  iziToast.error({\n    theme: 'dark',\n    message:\n      'Sorry, there are no images matching your search query. Please try again!',\n    messageSize: 16,\n    messageColor: '#fff',\n    backgroundColor: '#ef4040',\n    position: 'topRight',\n    progressBarColor: '#b51b1b',\n    maxWidth: 432,\n  });\n}\n\nexport function showLoader() {\n  refs.loader.classList.remove('load-box');\n}\nexport function hideLoader() {\n  refs.loader.classList.add('load-box');\n}\n\nexport function showLoadMoreBtn() {\n  refs.loadMoreBtn.classList.remove('hidden');\n}\nexport function hideLoadMoreBtn() {\n  refs.loadMoreBtn.classList.add('hidden');\n}\n\nexport function ScrollByClick() {\n  const liEl = refs.listEl.children[0];\n  const height = liEl.getBoundingClientRect().height * 2;\n  window.scrollBy({\n    top: height,\n    behavior: 'smooth',\n  });\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport { fetchImages } from './js/pixabay-api';\nimport {\n  ScrollByClick,\n  hideLoadMoreBtn,\n  hideLoader,\n  imagesTemplate,\n  refs,\n  showError,\n  showLoadMoreBtn,\n  showLoader,\n} from './js/render-functions';\nimport iziToast from 'izitoast';\n\nlet gallery = new SimpleLightbox('.list-item a', {\n  captionsData: 'alt',\n  captionPosition: 'bottom',\n  captionDelay: 200,\n});\n\nlet page = 1;\nlet userInput = '';\nlet maxPage = 1;\nconst perPage = 15;\n\nrefs.formEl.addEventListener('submit', onSubmitForm);\nrefs.loadMoreBtn.addEventListener('click', onClickLoadMoreBtn);\n\nasync function onSubmitForm(e) {\n  e.preventDefault();\n  refs.listEl.innerHTML = '';\n  page = 1;\n  userInput = refs.inputEl.value.trim();\n  if (userInput === '') {\n    return;\n  }\n\n  showLoader();\n  try {\n    const data = await fetchImages(userInput, page);\n    if (data.hits.length === 0) {\n      throw new Error();\n    }\n    maxPage = Math.ceil(data.totalHits / perPage);\n    const markup = imagesTemplate(data.hits);\n    refs.listEl.innerHTML = markup;\n    gallery.refresh();\n    checkLoadPage();\n    hideLoader();\n  } catch (err) {\n    hideLoadMoreBtn();\n    showError();\n    hideLoader();\n  }\n  refs.formEl.reset();\n}\n\nasync function onClickLoadMoreBtn() {\n  page++;\n  showLoader();\n  hideLoadMoreBtn();\n  try {\n    const data = await fetchImages(userInput, page);\n    if (data.hits.length === 0) {\n      throw new Error();\n    }\n    const markup = imagesTemplate(data.hits);\n    refs.listEl.insertAdjacentHTML('beforeend', markup);\n    gallery.refresh();\n    ScrollByClick();\n    hideLoader();\n  } catch (err) {\n    showError();\n    hideLoader();\n  }\n  checkLoadPage();\n}\n\nfunction checkLoadPage() {\n  if (page >= maxPage) {\n    hideLoadMoreBtn();\n    if (maxPage) {\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n    }\n  } else {\n    showLoadMoreBtn();\n  }\n}\n"],"names":["axios","fetchImages","userInput","currentPage","params","response","refs","imageTemplate","webformatURL","largeImageURL","tags","likes","views","comments","downloads","imagesTemplate","imagesArr","showError","iziToast","showLoader","hideLoader","showLoadMoreBtn","hideLoadMoreBtn","ScrollByClick","height","gallery","SimpleLightbox","page","maxPage","perPage","onSubmitForm","onClickLoadMoreBtn","e","data","markup","checkLoadPage"],"mappings":"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"}